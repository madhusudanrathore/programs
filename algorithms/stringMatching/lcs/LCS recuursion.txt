#include <iostream>
#include<string>
using namespace std;
int lcs(string str1, string str2, int pos1, int pos2, bool checkEqual) {
	if (pos1 == -1 || pos2 == -1)
		return 0;
	if (checkEqual) {
		if (str1[pos1] == str2[pos2]) {
			return (1 + lcs(str1, str2, pos1 - 1, pos2 - 1, true));
		}
		else {
			return 0;
		}
	}
	int r1 = 0;
	if (str1[pos1] == str2[pos2]) {
		r1 = 1 + lcs(str1, str2, pos1 - 1, pos2 - 1, true);
	}
	return max(r1, max(lcs(str1, str2, pos1 - 1, pos2, false), lcs(str1, str2, pos1, pos2 - 1, false)));
}
int main() {
	int n, q = 1, x = 1, y = 1;
	cin >> n >> q;
	string a[n];
	for (int i = 0; i<n; i++)
		cin >> a[i];

	for (int j = 0; j<q; j++) {
		cin >> x >> y;
		cout << lcs(a[x], a[y], a[x].length() - 1, a[y].length() - 1, false) << endl;
	}

	return 0;
}